"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[411],{411:(Y,_,c)=>{c.r(_),c.d(_,{PerfilUsuarioPageModule:()=>F});var d=c(177),u=c(4341),a=c(4742),h=c(4964),g=c(467),P=c(5039),e=c(4438),M=c(4796);const p=n=>({"ion-input-edit-custom":n}),f=n=>({"mb-0":n}),m=()=>({standalone:!0});function C(n,s){if(1&n&&(e.j41(0,"div",19)(1,"ion-card",20)(2,"ion-card-header",21)(3,"h2",22),e.EFF(4,"Error al mostrar datos"),e.k0s()(),e.j41(5,"ion-card-content")(6,"p",23),e.EFF(7),e.k0s()()()()),2&n){const i=e.XpG();e.R7$(7),e.SpI("Error: ",i.errorMessage,"")}}function b(n,s){if(1&n){const i=e.RV6();e.j41(0,"ion-icon",24),e.bIt("click",function(){e.eBV(i);const o=e.XpG();return e.Njj(o.editProfile())}),e.k0s()}}function I(n,s){if(1&n){const i=e.RV6();e.j41(0,"ion-icon",25),e.bIt("click",function(){e.eBV(i);const o=e.XpG();return e.Njj(o.saveProfile())}),e.k0s()}}function x(n,s){if(1&n){const i=e.RV6();e.j41(0,"ion-icon",26),e.bIt("click",function(){e.eBV(i);const o=e.XpG();return e.Njj(o.cancelEdit())}),e.k0s()}}function U(n,s){if(1&n&&e.nrm(0,"img",27),2&n){const i=e.XpG();e.Y8G("src",i.profileImageUrl,e.B4B)}}function R(n,s){1&n&&e.nrm(0,"ion-icon",28)}function v(n,s){if(1&n&&(e.j41(0,"p"),e.EFF(1),e.k0s()),2&n){const i=e.XpG(2);e.R7$(),e.JRh(i.user.fullName)}}function E(n,s){if(1&n){const i=e.RV6();e.j41(0,"ion-input",39),e.mxI("ngModelChange",function(o){e.eBV(i);const r=e.XpG(2);return e.DH7(r.tempNombreCompleto,o)||(r.tempNombreCompleto=o),e.Njj(o)}),e.k0s()}if(2&n){const i=e.XpG(2);e.R50("ngModel",i.tempNombreCompleto),e.Y8G("placeholder",i.user.fullName)("ngModelOptions",e.lJ4(3,m))}}function k(n,s){if(1&n&&(e.j41(0,"p"),e.EFF(1),e.k0s()),2&n){const i=e.XpG(2);e.R7$(),e.JRh(i.user.rut)}}function G(n,s){if(1&n){const i=e.RV6();e.j41(0,"ion-input",40),e.mxI("ngModelChange",function(o){e.eBV(i);const r=e.XpG(2);return e.DH7(r.tempRut,o)||(r.tempRut=o),e.Njj(o)}),e.k0s()}if(2&n){const i=e.XpG(2);e.R50("ngModel",i.tempRut),e.Y8G("placeholder",i.user.rut)("ngModelOptions",e.lJ4(3,m))}}function j(n,s){if(1&n&&(e.j41(0,"p"),e.EFF(1),e.k0s()),2&n){const i=e.XpG(2);e.R7$(),e.JRh(i.user.phone)}}function O(n,s){if(1&n){const i=e.RV6();e.j41(0,"ion-input",41),e.mxI("ngModelChange",function(o){e.eBV(i);const r=e.XpG(2);return e.DH7(r.tempTelefono,o)||(r.tempTelefono=o),e.Njj(o)}),e.k0s()}if(2&n){const i=e.XpG(2);e.R50("ngModel",i.tempTelefono),e.Y8G("placeholder",i.user.phone)("ngModelOptions",e.lJ4(3,m))}}function T(n,s){if(1&n&&(e.j41(0,"form",29)(1,"div",30)(2,"ion-item",31)(3,"ion-label",32)(4,"h3",23),e.EFF(5,"Nombre Completo"),e.k0s(),e.DNE(6,v,2,1,"p",33)(7,E,1,4,"ion-input",34),e.k0s()()(),e.j41(8,"div",30)(9,"ion-item",35)(10,"ion-label")(11,"h3",23),e.EFF(12,"Correo Electr\xf3nico"),e.k0s(),e.j41(13,"p"),e.EFF(14),e.k0s()()()(),e.j41(15,"div",30)(16,"ion-item",36)(17,"ion-label",32)(18,"h3",23),e.EFF(19,"RUT"),e.k0s(),e.DNE(20,k,2,1,"p",33)(21,G,1,4,"ion-input",37),e.k0s()()(),e.j41(22,"div",30)(23,"ion-item",36)(24,"ion-label",32)(25,"h3",23),e.EFF(26,"Tel\xe9fono"),e.k0s(),e.DNE(27,j,2,1,"p",33)(28,O,1,4,"ion-input",38),e.k0s()()()()),2&n){const i=e.XpG();e.R7$(2),e.Y8G("ngClass",e.eq3(13,p,i.isEditing)),e.R7$(),e.Y8G("ngClass",e.eq3(15,f,i.isEditing)),e.R7$(3),e.Y8G("ngIf",!i.isEditing),e.R7$(),e.Y8G("ngIf",i.isEditing),e.R7$(7),e.JRh(i.user.email),e.R7$(2),e.Y8G("ngClass",e.eq3(17,p,i.isEditing)),e.R7$(),e.Y8G("ngClass",e.eq3(19,f,i.isEditing)),e.R7$(3),e.Y8G("ngIf",!i.isEditing),e.R7$(),e.Y8G("ngIf",i.isEditing),e.R7$(2),e.Y8G("ngClass",e.eq3(21,p,i.isEditing)),e.R7$(),e.Y8G("ngClass",e.eq3(23,f,i.isEditing)),e.R7$(3),e.Y8G("ngIf",!i.isEditing),e.R7$(),e.Y8G("ngIf",i.isEditing)}}const y=[{path:"",component:(()=>{var n;class s{constructor(t,o,r,l){this.authService=t,this.toastController=o,this.menuController=r,this.modalController=l,this.profileImageUrl="",this.defaultProfileImage="assets/icon/default-profile.png",this.user=null,this.isEditing=!1,this.tempNombreCompleto="",this.tempEmail="",this.tempRut="",this.tempTelefono="",this.unreadNotificationsCount=0,this.usuario={}}openMenu(){this.menuController.open()}ngOnInit(){var t=this;return(0,g.A)(function*(){const o=localStorage.getItem("userId");o?t.loadUserData(o):t.errorMessage="Error: no se encontr\xf3 el usuario."})()}loadUserData(t){var o=this;return(0,g.A)(function*(){try{const r=yield o.authService.getUserById(t);r?(o.user=r,o.profileImageUrl=o.user.photoURL?o.user.photoURL:o.defaultProfileImage):o.errorMessage="No se encontr\xf3 el usuario."}catch(r){console.error("Error al cargar los datos del usuario:",r),o.errorMessage="Ocurri\xf3 un error al cargar los datos del usuario."}})()}uploadProfileImage(t){var o=this;return(0,g.A)(function*(){const r=t.target.files[0];if(r)try{const l=yield o.convertToBase64(r);o.user?(o.user.photoURL=l,yield o.authService.updateUser(o.user),o.showToast("Imagen de perfil actualizada correctamente.","success")):o.showToast("No se pudo actualizar la imagen de perfil. Usuario no definido.","danger")}catch{o.showToast("No se pudo actualizar la imagen de perfil.","danger")}else console.error("No se seleccion\xf3 ning\xfan archivo."),o.showToast("Por favor, selecciona una imagen para subir.","warning")})()}convertToBase64(t){return new Promise((o,r)=>{const l=new FileReader;l.onload=()=>o(l.result),l.onerror=$=>r($),l.readAsDataURL(t)})}editProfile(){var t,o,r,l;this.isEditing=!0,console.log("Editando perfil:",this.isEditing),this.tempNombreCompleto=(null===(t=this.user)||void 0===t?void 0:t.fullName)||"",this.tempEmail=(null===(o=this.user)||void 0===o?void 0:o.email)||"",this.tempRut=(null===(r=this.user)||void 0===r?void 0:r.rut)||"",this.tempTelefono=(null===(l=this.user)||void 0===l?void 0:l.phone)||""}saveProfile(){var t=this;return(0,g.A)(function*(){try{t.user&&(t.user.fullName=t.tempNombreCompleto,t.user.rut=t.tempRut,t.user.phone=t.tempTelefono,yield t.authService.updateUser(t.user),t.showToast("Los cambios se guardaron correctamente.","success"),t.isEditing=!1)}catch(o){console.error("Error al guardar el perfil:",o),t.showToast("Hubo un problema al guardar los cambios.","danger")}})()}cancelEdit(){this.isEditing=!1;const t=localStorage.getItem("userId");t?this.loadUserData(t):this.errorMessage="No se pudo encontrar el usuario."}showToast(t,o){var r=this;return(0,g.A)(function*(){(yield r.toastController.create({message:t,duration:2e3,color:o})).present()})()}openChat(t){var o=this;return(0,g.A)(function*(){return yield(yield o.modalController.create({component:P.d,componentProps:{usuario:t,receptorId:t.uid}})).present()})()}}return(n=s).\u0275fac=function(t){return new(t||n)(e.rXU(M.u),e.rXU(a.K_),e.rXU(a._t),e.rXU(a.W3))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-perfil-usuario"]],decls:28,vars:10,consts:[["slot","start"],["id","main-content",1,"main-content",3,"fullscreen"],["class","ion-padding",4,"ngIf"],[1,"ion-padding",2,"border-radius","1rem"],[1,"ion-align-items-center","justify-content-space-between","mb-1"],[1,"m-0","text-start",2,"color","white"],["size","auto"],[1,"icon-container"],["class","ion-icon-custom","color","dark","size","large","name","create-outline",3,"click",4,"ngIf"],["class","ion-icon-custom","color","dark","size","large","name","checkmark-outline",3,"click",4,"ngIf"],["class","ion-icon-custom","color","dark","size","large","name","close-outline",3,"click",4,"ngIf"],[1,"profile-image","mx-auto"],["alt","Imagen de perfil",3,"src",4,"ngIf"],["name","person-circle-outline","class","default-icon",4,"ngIf"],[1,"upload-overlay"],["name","camera-outline"],["type","file","accept","image/*","hidden","","id","fileInput",3,"change"],["for","fileInput",1,"upload-label"],["class","mt-3",4,"ngIf"],[1,"ion-padding"],[1,"error-card"],[1,"pb-0"],[1,"text-center"],[2,"font-weight","400"],["color","dark","size","large","name","create-outline",1,"ion-icon-custom",3,"click"],["color","dark","size","large","name","checkmark-outline",1,"ion-icon-custom",3,"click"],["color","dark","size","large","name","close-outline",1,"ion-icon-custom",3,"click"],["alt","Imagen de perfil",3,"src"],["name","person-circle-outline",1,"default-icon"],[1,"mt-3"],[1,"mb-3"],[1,"ion-input-custom","ps-0",3,"ngClass"],[3,"ngClass"],[4,"ngIf"],["name","nombreCompleto",3,"ngModel","placeholder","ngModelOptions","ngModelChange",4,"ngIf"],[1,"ion-input-custom"],[1,"ion-input-custom",3,"ngClass"],["name","rut",3,"ngModel","placeholder","ngModelOptions","ngModelChange",4,"ngIf"],["name","telefono",3,"ngModel","placeholder","ngModelOptions","ngModelChange",4,"ngIf"],["name","nombreCompleto",3,"ngModelChange","ngModel","placeholder","ngModelOptions"],["name","rut",3,"ngModelChange","ngModel","placeholder","ngModelOptions"],["name","telefono",3,"ngModelChange","ngModel","placeholder","ngModelOptions"]],template:function(t,o){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e.nrm(3,"ion-menu-button"),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Mi cuenta"),e.k0s()()(),e.j41(6,"ion-content",1),e.DNE(7,C,8,1,"div",2),e.j41(8,"ion-card",3)(9,"ion-grid")(10,"ion-row",4)(11,"ion-col")(12,"h2",5),e.EFF(13,"Informaci\xf3n personal"),e.k0s()(),e.j41(14,"ion-col",6)(15,"div",7),e.DNE(16,b,1,0,"ion-icon",8)(17,I,1,0,"ion-icon",9)(18,x,1,0,"ion-icon",10),e.k0s()()()(),e.j41(19,"div",11),e.DNE(20,U,1,1,"img",12)(21,R,1,0,"ion-icon",13),e.j41(22,"div",14),e.nrm(23,"ion-icon",15),e.j41(24,"input",16),e.bIt("change",function(l){return o.uploadProfileImage(l)}),e.k0s(),e.nrm(25,"label",17),e.k0s()(),e.nrm(26,"br"),e.DNE(27,T,29,25,"form",18),e.k0s()()),2&t&&(e.R7$(6),e.Y8G("fullscreen",!0),e.R7$(),e.Y8G("ngIf",o.errorMessage),e.R7$(9),e.Y8G("ngIf",!o.isEditing),e.R7$(),e.Y8G("ngIf",o.isEditing),e.R7$(),e.Y8G("ngIf",o.isEditing),e.R7$(2),e.Y8G("ngIf",o.profileImageUrl&&o.profileImageUrl!==o.defaultProfileImage),e.R7$(),e.Y8G("ngIf",!o.profileImageUrl||o.profileImageUrl===o.defaultProfileImage),e.R7$(),e.AVh("hidden",!o.isEditing),e.R7$(5),e.Y8G("ngIf",o.user))},dependencies:[d.YU,d.bT,u.qT,u.BC,u.cb,u.vS,u.cV,a.QW,a.b_,a.I9,a.ME,a.hU,a.W9,a.lO,a.eU,a.iq,a.$w,a.uz,a.he,a.MC,a.ln,a.BC,a.ai,a.Gw],styles:[".ion-title-custom[_ngcontent-%COMP%]{font-size:24px;font-weight:700;text-align:center}.error-card[_ngcontent-%COMP%]{--background: #f8d7da}.profile-image[_ngcontent-%COMP%]{width:140px;height:140px;border-radius:50%;overflow:hidden;border:3px solid rgb(87,189,132);display:flex;justify-content:center;align-items:center;position:relative;background-color:#f2f2f2;margin:0 auto}.profile-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.default-icon[_ngcontent-%COMP%]{font-size:100px;color:#ccc}.icon-container[_ngcontent-%COMP%]{display:flex;gap:15px}.icon-container[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;color:#57bd84;cursor:pointer;transition:color .3s ease,transform .3s ease}.icon-container[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]:hover{color:#57bd84;transform:scale(1.1)}.upload-overlay[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:50px;height:50px;border-radius:50%;background-color:#0009;display:flex;justify-content:center;align-items:center;cursor:pointer}.upload-overlay.hidden[_ngcontent-%COMP%]{display:none}.upload-overlay[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#fff;font-size:24px}.upload-label[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;cursor:pointer}.ion-input-custom[_ngcontent-%COMP%]{--background: #f2f2f2;--border-radius: 25px;--border-width: 0;--inner-border-width: 0;padding:10px 15px;margin-bottom:10px;box-shadow:2px 2px 5px #0000001a}.ion-input-edit-custom[_ngcontent-%COMP%]{--background: white}ion-item[_ngcontent-%COMP%]{--border-radius: 25px;--background: #f2f2f2;padding:10px;margin-bottom:10px;border-radius:25px}ion-label[_ngcontent-%COMP%]{font-weight:500;font-size:16px;color:#333;padding-left:10px;border-radius:25px}ion-input[_ngcontent-%COMP%]{--padding-start: 10px;--padding-end: 10px;border-radius:25px;font-size:16px;color:#000}.ion-input-custom[_ngcontent-%COMP%]:hover, ion-item[_ngcontent-%COMP%]:hover{background-color:#e6e6e6}ion-input[_ngcontent-%COMP%]:focus{outline:none}h3[_ngcontent-%COMP%]{font-weight:400;color:#333}.mb-3[_ngcontent-%COMP%]{margin-bottom:15px}.m-0[_ngcontent-%COMP%]{margin:0}.text-start[_ngcontent-%COMP%]{text-align:left}.chat-icon[_ngcontent-%COMP%]{position:fixed;bottom:20px;right:20px;z-index:1000;background:transparent;border:none;padding:0;font-size:20px;color:#fff}.default-icon[_ngcontent-%COMP%]{font-size:100px;color:#ccc;display:block;margin:auto}"]}),s})()}];let N=(()=>{var n;class s{}return(n=s).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[h.iI.forChild(y),h.iI]}),s})(),F=(()=>{var n;class s{}return(n=s).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[d.MD,u.YN,a.bv,N]}),s})()}}]);