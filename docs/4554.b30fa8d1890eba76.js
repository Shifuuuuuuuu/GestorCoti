"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4554],{4554:(M,u,c)=>{c.r(u),c.d(u,{GestorsolpesPageModule:()=>y});var d=c(177),h=c(4341),i=c(4742),g=c(4964),m=c(467),e=c(4438),f=c(4211),b=c(8079);const F=()=>[1,2];function C(t,s){1&t&&(e.j41(0,"ion-item")(1,"ion-thumbnail",2),e.nrm(2,"ion-skeleton-text",9),e.k0s(),e.j41(3,"ion-label")(4,"h3"),e.nrm(5,"ion-skeleton-text",10),e.k0s(),e.j41(6,"p"),e.nrm(7,"ion-skeleton-text",11),e.k0s(),e.j41(8,"p"),e.nrm(9,"ion-skeleton-text",12),e.k0s()()()),2&t&&(e.R7$(2),e.Y8G("animated",!0),e.R7$(3),e.Y8G("animated",!0),e.R7$(2),e.Y8G("animated",!0),e.R7$(2),e.Y8G("animated",!0))}function k(t,s){1&t&&(e.qex(0),e.j41(1,"ion-list")(2,"ion-list-header"),e.nrm(3,"ion-skeleton-text",7),e.k0s(),e.DNE(4,C,10,4,"ion-item",8),e.k0s(),e.bVm()),2&t&&(e.R7$(3),e.Y8G("animated",!0),e.R7$(),e.Y8G("ngForOf",e.lJ4(2,F)))}function P(t,s){if(1&t){const n=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.nI1(5,"currency"),e.k0s(),e.j41(6,"td")(7,"ion-button",28),e.bIt("click",function(){const r=e.eBV(n).index,a=e.XpG(2).$implicit,l=e.XpG(3);return e.Njj(l.eliminarComparacion(a,r))}),e.nrm(8,"ion-icon",29),e.k0s()()()}if(2&t){const n=s.$implicit;e.R7$(2),e.JRh(null==n.empresa?null:n.empresa.toUpperCase()),e.R7$(2),e.JRh(e.bMT(5,2,n.precio))}}function G(t,s){if(1&t&&(e.j41(0,"div")(1,"h5"),e.EFF(2,"Comparaciones:"),e.k0s(),e.j41(3,"table",19)(4,"thead")(5,"tr")(6,"th"),e.EFF(7,"Empresa"),e.k0s(),e.j41(8,"th"),e.EFF(9,"Precio"),e.k0s(),e.j41(10,"th"),e.EFF(11,"Acciones"),e.k0s()()(),e.j41(12,"tbody"),e.DNE(13,P,9,4,"tr",8),e.k0s()()()),2&t){const n=e.XpG().$implicit;e.R7$(13),e.Y8G("ngForOf",n.comparaciones)}}function x(t,s){if(1&t){const n=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.DNE(10,G,14,1,"div",23),e.nrm(11,"br"),e.j41(12,"ion-buttons")(13,"ion-button",24),e.bIt("click",function(){const r=e.eBV(n).$implicit,a=e.XpG(3);return e.Njj(a.abrirComparacion(r))}),e.nrm(14,"ion-icon",25),e.k0s(),e.j41(15,"ion-button",26),e.bIt("click",function(){e.eBV(n);const r=e.XpG().$implicit,a=e.XpG(2);return e.Njj(a.subirComparaciones(r))}),e.nrm(16,"ion-icon",27),e.k0s()()()()}if(2&t){const n=s.$implicit;e.R7$(2),e.JRh(n.item),e.R7$(2),e.JRh(null==n.descripcion?null:n.descripcion.toUpperCase()),e.R7$(2),e.JRh(null==n.codigo_referencial?null:n.codigo_referencial.toUpperCase()),e.R7$(2),e.JRh(n.cantidad),e.R7$(2),e.Y8G("ngIf",null==n.comparaciones?null:n.comparaciones.length)}}function j(t,s){if(1&t){const n=e.RV6();e.j41(0,"div",15)(1,"h3",16),e.EFF(2),e.k0s(),e.j41(3,"ion-card",17)(4,"div",18)(5,"table",19)(6,"thead")(7,"tr")(8,"th"),e.EFF(9,"Fecha"),e.k0s(),e.j41(10,"th"),e.EFF(11,"Contrato"),e.k0s(),e.j41(12,"th"),e.EFF(13,"Usuario"),e.k0s(),e.j41(14,"th"),e.EFF(15,"Estado"),e.k0s(),e.j41(16,"th"),e.EFF(17,"Acciones"),e.k0s()()(),e.j41(18,"tbody")(19,"tr")(20,"td"),e.EFF(21),e.k0s(),e.j41(22,"td"),e.EFF(23),e.k0s(),e.j41(24,"td"),e.EFF(25),e.k0s(),e.j41(26,"td"),e.EFF(27),e.k0s(),e.j41(28,"td")(29,"ion-button",20),e.bIt("click",function(){const r=e.eBV(n).$implicit,a=e.XpG(2);return e.Njj(a.cambiarEstatus(r))}),e.EFF(30," Cambiar Estatus "),e.k0s()()()()()()(),e.j41(31,"ion-card",21)(32,"div",22)(33,"table",19)(34,"thead")(35,"tr")(36,"th"),e.EFF(37,"Item"),e.k0s(),e.j41(38,"th"),e.EFF(39,"Descripci\xf3n"),e.k0s(),e.j41(40,"th"),e.EFF(41,"C\xf3digo"),e.k0s(),e.j41(42,"th"),e.EFF(43,"Cantidad"),e.k0s(),e.j41(44,"th"),e.EFF(45,"Comparaci\xf3n Precios"),e.k0s()()(),e.j41(46,"tbody"),e.DNE(47,x,17,5,"tr",8),e.k0s()()()()()}if(2&t){const n=s.$implicit;e.R7$(2),e.SpI("SOLPE N\xb0 ",n.numero_solpe,""),e.R7$(19),e.JRh(n.fecha),e.R7$(2),e.JRh(n.numero_contrato),e.R7$(2),e.JRh(n.usuario),e.R7$(2),e.JRh(n.estatus),e.R7$(20),e.Y8G("ngForOf",n.items)}}function E(t,s){if(1&t&&(e.j41(0,"ion-card",13),e.DNE(1,j,48,6,"div",14),e.k0s()),2&t){const n=e.XpG();e.R7$(),e.Y8G("ngForOf",n.solpes)}}const R=[{path:"",component:(()=>{var t;class s{constructor(o,r,a){this.solpeService=o,this.alertController=r,this.firestore=a,this.solpes=[],this.loading=!0,this.solpesFiltradas=[]}ngOnInit(){setTimeout(()=>{this.cargarSolpes(),this.loading=!1},2e3)}cargarSolpes(){this.solpeService.obtenerTodasLasSolpes().subscribe(o=>{const r=o.filter(a=>"Solicitado"===a.estatus);this.solpes=r.map(a=>(a.items=a.items.map(l=>({...l,comparaciones:l.comparaciones||[]})),a))})}cambiarEstatus(o){var r=this;return(0,m.A)(function*(){var l;yield(yield r.alertController.create({header:"Cambiar Estado de la SOLPE",inputs:[{name:"estatus",type:"radio",label:"Aprobado",value:"Aprobado"},{name:"estatus",type:"radio",label:"Rechazado",value:"Rechazado"},{name:"estatus",type:"radio",label:"Tr\xe1nsito a Faena",value:"Tr\xe1nsito a Faena"}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Siguiente",handler:(l=(0,m.A)(function*(p){p&&(yield(yield r.alertController.create({header:"Agregar Comentario",inputs:[{name:"comentario",type:"text",placeholder:"Escribe un comentario"}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Guardar",handler:_=>{r.firestore.collection("solpes").doc(o.id).update({estatus:p,comentario:_.comentario||""}).then(()=>{o.estatus=p,o.comentario=_.comentario||""})}}]})).present())}),function($){return l.apply(this,arguments)})}]})).present()})()}abrirComparacion(o){var r=this;return(0,m.A)(function*(){yield(yield r.alertController.create({header:"Agregar Comparaci\xf3n de Precios",inputs:[{name:"empresa",type:"text",placeholder:"Nombre de la Empresa"},{name:"precio",type:"number",placeholder:"Precio"}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Agregar",handler:l=>{if(l.empresa&&l.precio){const p=Date.now();o.comparaciones.push({id:p,empresa:l.empresa,precio:Number(l.precio)})}}}]})).present()})()}guardarComparacion(o,r){this.firestore.collection("solpes").doc(r).collection("items").doc(o.id).update({comparaciones:o.comparaciones})}eliminarComparacion(o,r){o.comparaciones.splice(r,1)}subirComparaciones(o){var r=this;return(0,m.A)(function*(){yield(yield r.alertController.create({header:"Confirmar",message:"\xbfEst\xe1s seguro de subir las comparaciones a Firestore?",buttons:[{text:"Cancelar",role:"cancel"},{text:"S\xed, subir",handler:()=>{r.firestore.collection("solpes").doc(o.id).update({items:o.items}).then(()=>{console.log("Comparaciones subidas a Firestore")}).catch(l=>{console.error("Error al subir comparaciones:",l)})}}]})).present()})()}}return(t=s).\u0275fac=function(o){return new(o||t)(e.rXU(f.h),e.rXU(i.hG),e.rXU(b.Qe))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-gestorsolpes"]],decls:11,vars:4,consts:[["contentLoaded",""],[3,"translucent"],["slot","start"],["defaultHref","/menu-cotizador",2,"color","white"],[2,"color","white"],[3,"fullscreen"],[4,"ngIf","ngIfElse"],[2,"width","50%",3,"animated"],[4,"ngFor","ngForOf"],[3,"animated"],[2,"width","80%",3,"animated"],[2,"width","60%",3,"animated"],[2,"width","30%",3,"animated"],[1,"main-card",2,"color","white"],["class","solpe-container",4,"ngFor","ngForOf"],[1,"solpe-container"],[2,"margin-left","1%"],[1,"inner-card",2,"color","white"],[1,"table-container"],[1,"styled-table"],["size","small",2,"--background","rgb(87, 189, 132)",3,"click"],[1,"inner-card"],[1,"table-container",2,"color","white"],[4,"ngIf"],["size","small",3,"click"],["name","add-circle-outline"],["color","success","size","small",3,"click"],["name","send-outline"],["color","danger","size","small","fill","clear",3,"click"],["name","close-outline"]],template:function(o,r){if(1&o&&(e.j41(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-buttons",2),e.nrm(3,"ion-back-button",3),e.k0s(),e.j41(4,"ion-title",4),e.EFF(5,"Gestor SOLPES"),e.k0s()()(),e.nrm(6,"br"),e.j41(7,"ion-content",5),e.DNE(8,k,5,3,"ng-container",6)(9,E,2,1,"ng-template",null,0,e.C5r),e.k0s()),2&o){const a=e.sdS(10);e.Y8G("translucent",!0),e.R7$(7),e.Y8G("fullscreen",!0),e.R7$(),e.Y8G("ngIf",r.loading)("ngIfElse",a)}},dependencies:[d.Sq,d.bT,i.Jm,i.QW,i.b_,i.W9,i.eU,i.iq,i.uz,i.he,i.nf,i.AF,i.ds,i.Zx,i.BC,i.ai,i.el,d.oe],styles:["ion-content[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0}.main-card[_ngcontent-%COMP%]{border-radius:25px;padding:10px;margin:0 5%}.solpe-container[_ngcontent-%COMP%]{margin-bottom:30px;padding:10px;border-radius:10px;box-shadow:0 4px 8px #0000001a}.inner-card[_ngcontent-%COMP%]{border-radius:15px;padding:10px}.table-container[_ngcontent-%COMP%]{margin-top:10px;overflow-x:auto}.styled-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:12px}.styled-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .styled-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 10px;text-align:left}.styled-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#57bd84;color:#fff}@media screen and (max-width: 600px){.styled-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .styled-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:6px 8px}.main-card[_ngcontent-%COMP%]{margin:0 2%;padding:5px}.solpe-container[_ngcontent-%COMP%]{padding:10px;margin-bottom:20px}.inner-card[_ngcontent-%COMP%]{padding:5px}ion-button[_ngcontent-%COMP%]{font-size:12px}h3[_ngcontent-%COMP%]{font-size:1.2rem;margin-left:2%}}"]}),s})()}];let v=(()=>{var t;class s{}return(t=s).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[g.iI.forChild(R),g.iI]}),s})(),y=(()=>{var t;class s{}return(t=s).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[d.MD,h.YN,i.bv,v]}),s})()}}]);