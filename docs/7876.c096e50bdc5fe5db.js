"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7876],{7876:(G,h,s)=>{s.r(h),s.d(h,{VisualizacionSolpedPageModule:()=>v});var u=s(177),_=s(4341),i=s(4742),F=s(4964),P=s(467),n=s(4438),k=s(8079),x=s(4211);function j(o,r){1&o&&(n.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),n.nrm(3,"ion-skeleton-text",5),n.k0s(),n.j41(4,"ion-card-subtitle"),n.nrm(5,"ion-skeleton-text",6),n.k0s(),n.j41(6,"ion-card-subtitle"),n.nrm(7,"ion-skeleton-text",7),n.k0s(),n.j41(8,"ion-card-subtitle"),n.nrm(9,"ion-skeleton-text",7),n.k0s()(),n.j41(10,"ion-card-content")(11,"ion-card",8)(12,"ion-grid")(13,"ion-row")(14,"ion-col",9),n.nrm(15,"ion-skeleton-text",10),n.k0s()()()()()()),2&o&&(n.R7$(3),n.Y8G("animated",!0),n.R7$(2),n.Y8G("animated",!0),n.R7$(2),n.Y8G("animated",!0),n.R7$(2),n.Y8G("animated",!0),n.R7$(6),n.Y8G("animated",!0))}function C(o,r){if(1&o&&(n.qex(0),n.DNE(1,j,16,5,"ion-card",4),n.bVm()),2&o){const t=n.XpG();n.R7$(),n.Y8G("ngForOf",t.solpedList)}}function S(o,r){if(1&o){const t=n.RV6();n.j41(0,"tr")(1,"td"),n.EFF(2),n.k0s(),n.j41(3,"td"),n.EFF(4),n.nI1(5,"currency"),n.k0s(),n.j41(6,"td")(7,"ion-button",19),n.bIt("click",function(){const a=n.eBV(t).$implicit,c=n.XpG(2).$implicit,l=n.XpG().$implicit,d=n.XpG(2);return n.Njj(d.eliminarComparacion(l.id,c.id,a.id))}),n.nrm(8,"ion-icon",20),n.k0s()()()}if(2&o){const t=r.$implicit;n.R7$(2),n.JRh(t.empresa),n.R7$(2),n.JRh(n.bMT(5,2,t.precio))}}function z(o,r){if(1&o&&(n.j41(0,"div")(1,"h5"),n.EFF(2,"Comparaciones:"),n.k0s(),n.j41(3,"table",12)(4,"thead")(5,"tr")(6,"th"),n.EFF(7,"Empresa"),n.k0s(),n.j41(8,"th"),n.EFF(9,"Precio"),n.k0s(),n.j41(10,"th"),n.EFF(11,"Acci\xf3n"),n.k0s()()(),n.j41(12,"tbody"),n.DNE(13,S,9,4,"tr",4),n.k0s()()()),2&o){const t=n.XpG().$implicit;n.R7$(13),n.Y8G("ngForOf",t.comparaciones)}}function M(o,r){if(1&o&&(n.j41(0,"tr")(1,"td"),n.EFF(2),n.k0s(),n.j41(3,"td"),n.EFF(4),n.k0s(),n.j41(5,"td"),n.EFF(6),n.k0s(),n.j41(7,"td"),n.EFF(8),n.k0s(),n.j41(9,"td"),n.DNE(10,z,14,1,"div",3),n.k0s()()),2&o){const t=r.$implicit;n.R7$(2),n.JRh(t.item),n.R7$(2),n.JRh(t.descripcion),n.R7$(2),n.JRh(t.codigo_referencial),n.R7$(2),n.JRh(t.cantidad),n.R7$(2),n.Y8G("ngIf",null==t.comparaciones?null:t.comparaciones.length)}}function E(o,r){if(1&o){const t=n.RV6();n.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),n.EFF(3),n.k0s(),n.j41(4,"ion-card-subtitle"),n.EFF(5),n.k0s(),n.j41(6,"ion-card-subtitle"),n.EFF(7),n.k0s(),n.j41(8,"ion-card-subtitle"),n.EFF(9),n.k0s()(),n.j41(10,"ion-card-content")(11,"ion-card",8)(12,"ion-grid")(13,"ion-row")(14,"ion-col",9)(15,"table",12)(16,"thead")(17,"tr")(18,"th"),n.EFF(19,"Item"),n.k0s(),n.j41(20,"th"),n.EFF(21,"Descripci\xf3n"),n.k0s(),n.j41(22,"th"),n.EFF(23,"C\xf3digo"),n.k0s(),n.j41(24,"th"),n.EFF(25,"Cantidad"),n.k0s(),n.j41(26,"th"),n.EFF(27,"Comparaci\xf3n Precios"),n.k0s()()(),n.j41(28,"tbody"),n.DNE(29,M,11,5,"tr",4),n.k0s()()()()()(),n.j41(30,"ion-item")(31,"ion-label",13),n.EFF(32,"Comentario"),n.k0s(),n.j41(33,"ion-textarea",14),n.mxI("ngModelChange",function(a){const c=n.eBV(t).$implicit;return n.DH7(c.comentario,a)||(c.comentario=a),n.Njj(a)}),n.k0s()(),n.j41(34,"ion-row",15)(35,"ion-col",16)(36,"ion-button",17),n.bIt("click",function(){const a=n.eBV(t).$implicit,c=n.XpG(2);return n.Njj(c.aprobarSolped(a))}),n.EFF(37," Aprobar "),n.k0s()(),n.j41(38,"ion-col",16)(39,"ion-button",18),n.bIt("click",function(){const a=n.eBV(t).$implicit,c=n.XpG(2);return n.Njj(c.rechazarSolped(a))}),n.EFF(40," Rechazar "),n.k0s()()()()()}if(2&o){const t=r.$implicit;n.R7$(3),n.SpI("N\xb0 SOLPED: ",t.numero_solpe,""),n.R7$(2),n.SpI("Fecha: ",t.fecha,""),n.R7$(2),n.SpI("Usuario: ",t.usuario,""),n.R7$(2),n.SpI("Estado: ",t.estatus,""),n.R7$(20),n.Y8G("ngForOf",t.items),n.R7$(4),n.R50("ngModel",t.comentario)}}function R(o,r){1&o&&(n.j41(0,"div",21),n.nrm(1,"ion-icon",22),n.k0s())}function O(o,r){if(1&o&&(n.qex(0),n.DNE(1,E,41,6,"ion-card",4)(2,R,2,0,"div",11),n.bVm()),2&o){const t=n.XpG();n.R7$(),n.Y8G("ngForOf",t.solpedList),n.R7$(),n.Y8G("ngIf",0===t.solpedList.length)}}const V=[{path:"",component:(()=>{var o;class r{constructor(e,a,c){this.firestore=e,this.alertCtrl=a,this.solpeService=c,this.solpedList=[],this.loading=!0}ngOnInit(){setTimeout(()=>{this.cargarSolped(),this.loading=!1},2e3)}cargarSolped(){this.solpeService.obtenerTodasLasSolpes().subscribe(e=>{const a=e.filter(c=>"Solicitado"===c.estatus);this.solpedList=a.map(c=>(c.items=c.items?c.items.map(l=>({...l,comparaciones:l.comparaciones||[]})):[],c))})}aprobarSolped(e){this.actualizarEstado(e.id,"Aprobado",e.comentario)}rechazarSolped(e){this.actualizarEstado(e.id,"Rechazado",e.comentario)}actualizarEstado(e,a,c){var l=this;return(0,P.A)(function*(){try{yield l.firestore.collection("solpes").doc(e).update({estatus:a,comentario:c}),yield(yield l.alertCtrl.create({header:"\xc9xito",message:`SOLPED ${a}`,buttons:["OK"]})).present(),l.cargarSolped()}catch(d){console.error("Error al actualizar:",d),yield(yield l.alertCtrl.create({header:"Error",message:"Hubo un problema al actualizar el estado.",buttons:["OK"]})).present()}})()}eliminarComparacion(e,a,c){var l=this;return(0,P.A)(function*(){const d=l.firestore.collection("solpes").doc(e);try{const p=yield d.get().toPromise();if(p&&p.exists){const m=p.data(),b=(null==m?void 0:m.items)||[],f=b.find(g=>g.id===a);if(f){const g=f.comparaciones.findIndex(y=>y.id===c);-1!==g?(f.comparaciones.splice(g,1),yield d.update({items:b})):console.log("\u274c Comparaci\xf3n no encontrada")}else console.log("\u274c \xcdtem no encontrado")}else console.log("\u274c Documento no encontrado o vac\xedo")}catch(p){console.error("Error eliminando la comparaci\xf3n:",p)}})()}}return(o=r).\u0275fac=function(e){return new(e||o)(n.rXU(k.Qe),n.rXU(i.hG),n.rXU(x.h))},o.\u0275cmp=n.VBU({type:o,selectors:[["app-visualizacion-solped"]],decls:9,vars:2,consts:[["slot","start"],["defaultHref","/home",2,"color","white"],[1,"ion-padding"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"width","50%",3,"animated"],[2,"width","30%",3,"animated"],[2,"width","40%",3,"animated"],[1,"inner-card"],["size","12"],[2,"width","100%","height","200px",3,"animated"],["class","no-solped-container",4,"ngIf"],[1,"styled-table"],["position","floating"],[3,"ngModelChange","ngModel"],[1,"ion-justify-content-between","ion-padding-top"],["size","6"],["expand","block",2,"--background","rgb(87, 189, 132)",3,"click"],["shape","Round","color","danger","expand","block",3,"click"],["color","danger","fill","clear",3,"click"],["name","close-circle"],[1,"no-solped-container"],["name","cloud-offline-outline",1,"no-solped-icon"]],template:function(e,a){1&e&&(n.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),n.nrm(3,"ion-back-button",1),n.k0s(),n.j41(4,"ion-title"),n.EFF(5,"Gesti\xf3n de SOLPED"),n.k0s()()(),n.j41(6,"ion-content",2),n.DNE(7,C,2,1,"ng-container",3)(8,O,3,2,"ng-container",3),n.k0s()),2&e&&(n.R7$(7),n.Y8G("ngIf",a.loading),n.R7$(),n.Y8G("ngIf",!a.loading))},dependencies:[u.Sq,u.bT,_.BC,_.vS,i.Jm,i.QW,i.b_,i.I9,i.ME,i.HW,i.tN,i.hU,i.W9,i.lO,i.eU,i.iq,i.uz,i.he,i.ln,i.ds,i.nc,i.BC,i.ai,i.Gw,i.el,u.oe],styles:[".table-container[_ngcontent-%COMP%]{margin-top:10px;overflow-x:auto}.styled-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:12px}.styled-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .styled-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;text-align:left}ion-card-title[_ngcontent-%COMP%]{color:#fff}ion-card-subtitle[_ngcontent-%COMP%]{color:#fff}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{color:#fff}.styled-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#57bd84;color:#fff}.styled-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{word-wrap:break-word}.inner-card[_ngcontent-%COMP%]{border-radius:15px;padding:10px}.solpe-container[_ngcontent-%COMP%]{margin-bottom:30px;padding:15px;border-radius:20px}@media screen and (max-width: 600px){.styled-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .styled-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:6px 8px}.main-card[_ngcontent-%COMP%]{margin:0 2%;padding:5px}.solpe-container[_ngcontent-%COMP%]{padding:10px;margin-bottom:20px}.inner-card[_ngcontent-%COMP%]{padding:5px}ion-button[_ngcontent-%COMP%]{font-size:12px}h3[_ngcontent-%COMP%]{font-size:1.2rem;margin-left:2%}}.no-solped-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:60vh;text-align:center}.no-solped-icon[_ngcontent-%COMP%]{font-size:48px;color:#fff;margin-top:20px}"]}),r})()}];let $=(()=>{var o;class r{}return(o=r).\u0275fac=function(e){return new(e||o)},o.\u0275mod=n.$C({type:o}),o.\u0275inj=n.G2t({imports:[F.iI.forChild(V),F.iI]}),r})(),v=(()=>{var o;class r{}return(o=r).\u0275fac=function(e){return new(e||o)},o.\u0275mod=n.$C({type:o}),o.\u0275inj=n.G2t({imports:[u.MD,_.YN,i.bv,$]}),r})()}}]);