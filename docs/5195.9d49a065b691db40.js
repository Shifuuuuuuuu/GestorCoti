"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5195],{5195:(j,b,a)=>{a.r(b),a.d(b,{RegistrarUsuarioPageModule:()=>R});var v=a(177),u=a(4341),s=a(4742),p=a(4964),h=a(467),e=a(4438),x=a(1182),y=a(8079);const U=[{path:"",component:(()=>{var n;class l{constructor(r,t,o,i,d){this.afAuth=r,this.firestore=t,this.toastController=o,this.router=i,this.menu=d}register(r){var t=this;return(0,h.A)(function*(){r&&r.preventDefault();const o=document.getElementById("fullName").value.trim();let i=document.getElementById("rut").value.trim();const d=document.getElementById("email").value.trim();let m=document.getElementById("phone").value.trim();const P=document.getElementById("password").value,M=document.getElementById("role").value;if(/^[a-zA-Z0-9._%+-]+@xtrememining\.cl$/.test(d))if(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{5,10}$/.test(P)){i=t.formatRUTForSave(i),m=t.formatPhoneForSave(m);try{const g=(yield t.afAuth.createUserWithEmailAndPassword(d,P)).user;if(g){yield g.sendEmailVerification();const C=yield g.getIdToken(),F={uid:g.uid,fullName:o,rut:i,email:d,phone:m,role:M,createdAt:new Date,token:C};yield t.firestore.collection("Usuarios").doc(g.uid).set(F),t.presentToast("Usuario registrado. Por favor verifica tu correo.","success"),setTimeout(()=>{t.router.navigate(["/iniciar-sesion"])},2e3)}}catch(f){console.error("Error durante el registro:",f),t.presentToast(f.message||"Ocurri\xf3 un error desconocido.","danger")}}else t.presentToast("La contrase\xf1a debe tener entre 5 y 10 caracteres, con 1 may\xfascula, 1 n\xfamero y 1 caracter especial.","danger");else t.presentToast("El correo debe ser del dominio @xtrememining.cl","danger")})()}formatRUTForSave(r){const t=r.replace(/\D/g,"");return`${t.slice(0,2)}-${t.slice(2,5)}-${t.slice(5,8)}-${t.slice(8)}`}formatPhoneForSave(r){return`+56${r.replace(/\D/g,"")}`}formatRUT(r){let t=r.target.value.replace(/\D/g,"");t.length>8&&(t=t.substring(0,8)+"-"+t.substring(8));let o="";o=t.length>1?t.slice(0,-1).replace(/\B(?=(\d{3})+(?!\d))/g,".")+""+t.slice(-1):t,r.target.value=o}formatPhone(r){r.target.value=r.target.value.replace(/\D/g,"").substring(0,8)}presentToast(r,t){var o=this;return(0,h.A)(function*(){(yield o.toastController.create({message:r,color:t,duration:2e3,position:"top"})).present()})()}ionViewWillEnter(){this.menu.enable(!1)}ngOnInit(){}}return(n=l).\u0275fac=function(r){return new(r||n)(e.rXU(x.DS),e.rXU(y.Qe),e.rXU(s.K_),e.rXU(p.Ix),e.rXU(s._t))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-registrar-usuario"]],decls:42,vars:0,consts:[["slot","start"],["defaultHref","/iniciar-sesion",2,"color","white"],[1,"form-control",3,"submit"],[1,"title"],[1,"input-field"],["required","","type","text","id","fullName",1,"input"],["for","fullName",1,"label"],["required","","type","text","id","rut","maxlength","12",1,"input",3,"input"],["for","rut",1,"label"],["required","","type","email","id","email","pattern","^[a-zA-Z0-9._%+-]+@xtrememining\\.cl$",1,"input"],["for","email",1,"label"],[2,"display","flex","align-items","center"],["type","text","value","+569","disabled","",1,"input",2,"width","60px"],["required","","type","tel","id","phone","maxlength","8","pattern","^\\d{8}$","placeholder","Ej: 48096007",1,"input",2,"flex","1",3,"input"],["for","phone",1,"label"],["id","role","required","",1,"input"],["value","Generador solped"],["value","Editor"],["value","Aprobador/Editor"],["for","role",1,"label"],["required","","type","password","id","password","maxlength","10","minlength","5","pattern","^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[\\W_]).{5,10}$","placeholder","M\xedn 5 - M\xe1x 10 caracteres",1,"input"],["for","password",1,"label"],["type","submit",1,"submit-btn"]],template:function(r,t){1&r&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e.nrm(3,"ion-back-button",1),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Registrar Usuario"),e.k0s()()(),e.j41(6,"ion-content")(7,"form",2),e.bIt("submit",function(i){return t.register(i)}),e.j41(8,"p",3),e.EFF(9,"Reg\xedstrate"),e.k0s(),e.j41(10,"div",4),e.nrm(11,"input",5),e.j41(12,"label",6),e.EFF(13,"Escribe tu Nombre"),e.k0s()(),e.j41(14,"div",4)(15,"input",7),e.bIt("input",function(i){return t.formatRUT(i)}),e.k0s(),e.j41(16,"label",8),e.EFF(17,"Escribe tu RUT"),e.k0s()(),e.j41(18,"div",4),e.nrm(19,"input",9),e.j41(20,"label",10),e.EFF(21,"Email (solo @xtrememining.cl)"),e.k0s()(),e.j41(22,"div",4)(23,"div",11),e.nrm(24,"input",12),e.j41(25,"input",13),e.bIt("input",function(i){return t.formatPhone(i)}),e.k0s()(),e.nrm(26,"label",14),e.k0s(),e.j41(27,"div",4)(28,"select",15)(29,"option",16),e.EFF(30,"Generador de solped"),e.k0s(),e.j41(31,"option",17),e.EFF(32,"Editor"),e.k0s(),e.j41(33,"option",18),e.EFF(34,"Aprobador/Editor"),e.k0s()(),e.j41(35,"label",19),e.EFF(36,"Selecciona tu perfil"),e.k0s()(),e.j41(37,"div",4),e.nrm(38,"input",20)(39,"label",21),e.k0s(),e.j41(40,"button",22),e.EFF(41,"Registrar"),e.k0s()()())},dependencies:[u.qT,u.xH,u.y7,u.cb,u.cV,s.QW,s.W9,s.eU,s.BC,s.ai,s.el],styles:["ion-content[_ngcontent-%COMP%]{--background: #121212;display:flex;justify-content:center;align-items:center;height:100vh}.form-control[_ngcontent-%COMP%]{background-color:#1e1e1e;width:80%;max-width:400px;display:flex;flex-direction:column;padding:25px;border-radius:8px;margin-top:5%;margin-left:auto;margin-right:auto}.title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;color:#fff;text-align:center}.input-field[_ngcontent-%COMP%]{position:relative;width:100%}.input[_ngcontent-%COMP%]{margin-top:15px;width:100%;outline:none;border-radius:8px;height:50px;border:none;background:#2a2a2a;padding-left:10px;color:#fff}.input[_ngcontent-%COMP%]:focus{border:1.5px solid rgb(87,189,132)}.label[_ngcontent-%COMP%]{position:absolute;top:20px;left:15px;color:#b0b0b0;transition:all .3s ease}.input[_ngcontent-%COMP%]:focus ~ .label[_ngcontent-%COMP%], .input[_ngcontent-%COMP%]:valid ~ .label[_ngcontent-%COMP%]{top:5px;left:10px;font-size:12px;color:#57bd84}.submit-btn[_ngcontent-%COMP%]{margin-top:30px;height:50px;background:#57bd84;border-radius:12px;border:none;color:#fff;font-size:18px;font-weight:700;cursor:pointer;width:100%}.submit-btn[_ngcontent-%COMP%]:hover{background:#57bd84}.redirect-register[_ngcontent-%COMP%]{text-align:center;margin-top:15px}.redirect-register[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#57bd84;font-weight:700;text-decoration:none}.redirect-register[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}"]}),l})()}];let E=(()=>{var n;class l{}return(n=l).\u0275fac=function(r){return new(r||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[p.iI.forChild(U),p.iI]}),l})(),R=(()=>{var n;class l{}return(n=l).\u0275fac=function(r){return new(r||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[v.MD,u.YN,s.bv,E]}),l})()}}]);